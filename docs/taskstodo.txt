MOONFLOWER HOTEL AUTOMATION - COMPLETE TASK LIST
=====================================================

ğŸ“… DAILY AUTOMATION TASKS (365-DAY OPERATION):

ğŸ—‚ï¸ 1. FOLDER MANAGEMENT
   â”œâ”€â”€ Create daily date folders (format: ddMMM like 29jul)
   â”œâ”€â”€ Setup: EHC_Data/[date]/ for CSV files
   â”œâ”€â”€ Setup: EHC_Data_Merge/[date]/ for Excel files  
   â”œâ”€â”€ Setup: EHC_Data_Pdf/[date]/ for PDF reports
   â”œâ”€â”€ Setup: EHC_Logs/[date]/ for daily logs
   â””â”€â”€ Cleanup: Remove folders older than 7 days

ğŸ“¥ 2. CSV FILE DOWNLOADS
   â”œâ”€â”€ Connect to WiFi controller web interface
   â”œâ”€â”€ Login with credentials (automated)
   â”œâ”€â”€ Navigate to Wireless LANs section
   â”œâ”€â”€ Download CSV files from multiple access points:
   â”‚   â”œâ”€â”€ EHC TV (main hotel TV network)
   â”‚   â”œâ”€â”€ EHC-15 (conference room)
   â”‚   â”œâ”€â”€ Reception Hall-Mobile (mobile devices)
   â”‚   â””â”€â”€ Reception Hall-TV (reception area)
   â”œâ”€â”€ Validate downloads (minimum 4 CSV files)
   â”œâ”€â”€ Check file sizes (ensure data exists)
   â””â”€â”€ Save to EHC_Data/[date]/ folder

ğŸ“Š 3. EXCEL FILE GENERATION
   â”œâ”€â”€ Parse all CSV files from today's folder
   â”œâ”€â”€ Normalize column headers (handle variations)
   â”œâ”€â”€ Merge data from all CSV files
   â”œâ”€â”€ Apply data cleaning and filtering
   â”œâ”€â”€ Generate Excel file (.xls format for VBS compatibility)
   â”œâ”€â”€ Filename: EHC_Upload_Mac_[DDMMYYYY].xls
   â”œâ”€â”€ Validate row count (minimum 6000+ rows expected)
   â””â”€â”€ Save to EHC_Data_Merge/[date]/ folder

ğŸ“§ 4. EMAIL NOTIFICATIONS
   â”œâ”€â”€ 4A. MILESTONE NOTIFICATIONS (to faseenm@gmail.com):
   â”‚   â”œâ”€â”€ Send after CSV download completion
   â”‚   â”œâ”€â”€ Send after Excel merge completion  
   â”‚   â”œâ”€â”€ Send after VBS upload completion
   â”‚   â”œâ”€â”€ Format: Simple, clear, no emojis
   â”‚   â””â”€â”€ Include file counts and status
   â”‚
   â””â”€â”€ 4B. GM DAILY REPORTS (to ramon.logan@absons.ae):
       â”œâ”€â”€ Send between 9:00-9:30 AM daily
       â”œâ”€â”€ From: mohamed.fasin@absons.ae
       â”œâ”€â”€ Attach previous day's PDF report
       â”œâ”€â”€ Professional format with signature
       â”œâ”€â”€ Subject: Daily WiFi Usage Report
       â””â”€â”€ Only on weekdays (Monday-Friday)

ğŸ–¥ï¸ 5. VBS APPLICATION AUTOMATION
   â”œâ”€â”€ 5A. VBS PHASE 1 (LOGIN):
   â”‚   â”œâ”€â”€ Launch AbsonsItERP.exe application
   â”‚   â”œâ”€â”€ Handle security popup (Alt+R bypass)
   â”‚   â”œâ”€â”€ Wait for login window to appear
   â”‚   â”œâ”€â”€ Execute two-cycle login sequence
   â”‚   â”œâ”€â”€ Clear all fields first, then fill
   â”‚   â””â”€â”€ Verify successful login
   â”‚
   â”œâ”€â”€ 5B. VBS PHASE 2 (NAVIGATION):
   â”‚   â”œâ”€â”€ Click Arrow button to open menu
   â”‚   â”œâ”€â”€ Navigate: Sales & Distribution â†’ POS
   â”‚   â”œâ”€â”€ Use DOWN arrow keys (3 times) for navigation
   â”‚   â”œâ”€â”€ Select: WiFi User Registration
   â”‚   â”œâ”€â”€ Click New button for new record
   â”‚   â””â”€â”€ Select Credit radio button
   â”‚
   â”œâ”€â”€ 5C. VBS PHASE 3 (DATA UPLOAD):
   â”‚   â”œâ”€â”€ Click Import EHC checkbox
   â”‚   â”œâ”€â”€ Click three dots button (file browser)
   â”‚   â”œâ”€â”€ Navigate to Excel merge folder via address bar
   â”‚   â”œâ”€â”€ Select today's Excel file
   â”‚   â”œâ”€â”€ Handle sheet selection dialog
   â”‚   â”œâ”€â”€ Execute import process (wait 15 minutes)
   â”‚   â”œâ”€â”€ Detect import completion popup (audio/visual)
   â”‚   â”œâ”€â”€ Click update button (multiple variants):
   â”‚   â”‚   â”œâ”€â”€ Try 09_update_button.png
   â”‚   â”‚   â”œâ”€â”€ Try 09_update_button_variant1.png
   â”‚   â”‚   â””â”€â”€ Try 09_update_button_variant2.png
   â”‚   â”œâ”€â”€ Monitor upload progress (3 hours)
   â”‚   â”œâ”€â”€ Detect upload success popup (09_update_success_ok_button.png)
   â”‚   â”œâ”€â”€ Click OK to dismiss popup
   â”‚   â”œâ”€â”€ Wait 15 seconds before closing
   â”‚   â””â”€â”€ Close VBS application (Alt+F4 + Enter)
   â”‚
   â””â”€â”€ 5D. VBS PHASE 4 (PDF REPORT GENERATION):
       â”œâ”€â”€ Fresh VBS login (Phase 1 again)
       â”œâ”€â”€ Navigate: Arrow â†’ Sales & Distribution â†’ Reports
       â”œâ”€â”€ Scroll DOWN 54 times to WiFi Active Users Count
       â”œâ”€â”€ Double-click to open report
       â”œâ”€â”€ Set date range: Start of month to current date
       â”œâ”€â”€ Print preview (wait 1 minute for processing)
       â”œâ”€â”€ Export to PDF format
       â”œâ”€â”€ Navigate to save location via address bar
       â”œâ”€â”€ Save to EHC_Data_Pdf/[date]/ folder
       â”œâ”€â”€ Filename: MoonFlower Active Users [DD_MM_YYYY].pdf
       â””â”€â”€ Close VBS application

ğŸ“‹ 6. LOGGING & MONITORING
   â”œâ”€â”€ Create detailed logs for each component:
   â”‚   â”œâ”€â”€ CSV download logs with success/failure status
   â”‚   â”œâ”€â”€ Excel merge logs with row counts
   â”‚   â”œâ”€â”€ VBS automation logs with step completion
   â”‚   â”œâ”€â”€ Email delivery logs with timestamps
   â”‚   â””â”€â”€ Error logs with stack traces
   â”œâ”€â”€ Centralize all logs in EHC_Logs/[date]/ folder
   â”œâ”€â”€ Log rotation: Keep 7 days of logs
   â”œâ”€â”€ Performance monitoring (execution times)
   â””â”€â”€ Status tracking with daily_status.txt

ğŸ”„ 7. SCHEDULING & AUTOMATION
   â”œâ”€â”€ Windows Task Scheduler integration
   â”œâ”€â”€ Run at optimal times to avoid conflicts:
   â”‚   â”œâ”€â”€ 00:01 AM - Daily folder creation
   â”‚   â”œâ”€â”€ 09:05 AM - Morning email to GM
   â”‚   â”œâ”€â”€ 11:00 AM - Main automation (CSVâ†’Excelâ†’VBS)
   â”‚   â””â”€â”€ Tasks complete by 7:00 PM daily
   â”œâ”€â”€ 365-day continuous operation
   â”œâ”€â”€ Admin permissions for all tasks
   â”œâ”€â”€ Handle PC lock/unlock if needed
   â””â”€â”€ Self-recovery from failures

ğŸ› ï¸ 8. SYSTEM MAINTENANCE
   â”œâ”€â”€ Monitor VBS application responsiveness
   â”œâ”€â”€ Handle "Not Responding" states (normal during upload)
   â”œâ”€â”€ Process termination and cleanup
   â”œâ”€â”€ Disk space monitoring
   â”œâ”€â”€ Network connectivity checks
   â”œâ”€â”€ Automatic error recovery
   â””â”€â”€ System health reporting

âš ï¸ 9. ERROR HANDLING & RECOVERY
   â”œâ”€â”€ Network connectivity issues
   â”œâ”€â”€ VBS application crashes or hangs
   â”œâ”€â”€ File download failures
   â”œâ”€â”€ Email delivery failures
   â”œâ”€â”€ Authentication problems
   â”œâ”€â”€ Disk space issues
   â”œâ”€â”€ Popup detection failures
   â””â”€â”€ Automatic retry mechanisms

ğŸ¯ 10. QUALITY ASSURANCE
    â”œâ”€â”€ Validate file counts and sizes
    â”œâ”€â”€ Verify data integrity in Excel files
    â”œâ”€â”€ Confirm PDF generation success
    â”œâ”€â”€ Test email delivery reliability
    â”œâ”€â”€ Monitor VBS automation accuracy
    â”œâ”€â”€ Check image recognition confidence
    â”œâ”€â”€ Validate date folder creation
    â””â”€â”€ End-to-end workflow testing

=====================================================
EXECUTION ORDER FOR COMPLETE WORKFLOW:
=====================================================

1. Create daily folders
2. Download CSV files (4+ files expected)
3. Generate Excel merge file (6000+ rows expected)
4. Send CSV/Excel completion notification
5. Execute VBS Phase 1 (Login)
6. Execute VBS Phase 2 (Navigation)
7. Execute VBS Phase 3 (Import + Upload + 3hr wait)
8. Close VBS application
9. Execute VBS Phase 1 (Fresh login)
10. Execute VBS Phase 4 (PDF Report generation)
11. Close VBS application
12. Send VBS completion notification
13. Schedule next day's GM email
14. Generate summary logs

ESTIMATED TOTAL TIME: ~4 hours (mostly upload wait time)
TARGET COMPLETION: Before 7:00 PM daily
HUMAN INTERVENTION: ZERO (fully autonomous) 