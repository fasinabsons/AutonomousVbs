===============================================================================
ðŸŒ™ MOONFLOWER AUTOMATION ENHANCED - COMPLETE INSTALLATION GUIDE
365-Day Robust Operation for Any Windows PC
===============================================================================

ðŸ“‹ OVERVIEW:
This guide installs the MoonFlower AutomationMaster Enhanced system on any Windows PC.
After installation, the system will run continuously for 365 days with automatic restart,
error recovery, catch-up logic, and complete monitoring.

ðŸ†• ENHANCED FEATURES:
âœ… Single instance protection with lock files
âœ… Task Scheduler auto-start integration (boot, login, daily)
âœ… Dynamic CSV slot management (easily extensible) 
âœ… Enhanced catch-up logic for missed tasks
âœ… Configuration validation and dependency checking
âœ… Network connectivity validation before operations
âœ… Performance metrics and status monitoring
âœ… Advanced error handling with retry mechanisms
âœ… File integrity validation (size, age, completion)
âœ… Login-triggered catch-up execution

===============================================================================
ðŸ› ï¸ STEP 1: PYTHON INSTALLATION (REQUIRED)
===============================================================================

1.1 Download Python:
   â€¢ Go to: https://python.org
   â€¢ Click "Download Python" (latest version)
   â€¢ Download the Windows installer (.exe file)

1.2 Install Python:
   â€¢ Run the downloaded .exe file
   â€¢ âš ï¸ IMPORTANT: Check "Add Python to PATH" checkbox
   â€¢ Choose "Install Now"
   â€¢ Wait for installation to complete
   â€¢ Click "Close"

1.3 Verify Python Installation:
   â€¢ Open Command Prompt (cmd)
   â€¢ Type: python --version
   â€¢ You should see: Python 3.x.x
   â€¢ If error, restart computer and try again

===============================================================================
ðŸŒ STEP 2: CHROME BROWSER CONFIGURATION (CRITICAL FOR AUTOMATION)
===============================================================================

2.1 Download and Install Chrome:
   â€¢ Go to: https://google.com/chrome
   â€¢ Download and install the latest version

2.2 CRITICAL Chrome Settings for Automation:
   Open Chrome and configure these settings:

   Downloads (chrome://settings/downloads):
   â€¢ Set download location to: C:\Users\[YourName]\Downloads
   â€¢ Turn OFF "Ask where to save each file before downloading"
   â€¢ Turn ON "Always show downloads when they're done"

   Site Permissions (chrome://settings/content):
   â€¢ Automatic downloads: "Sites can download multiple files"
   â€¢ Pop-ups and redirects: "Sites can send pop-ups and use redirects"
   â€¢ JavaScript: "Sites can use JavaScript" (enabled)

   Display Settings (CRITICAL):
   â€¢ Keep Windows Display Scale at 100% (Settings > Display)
   â€¢ Keep Chrome zoom at 100% (Ctrl+0 to reset)
   â€¢ Keep Chrome UI language in English
   â€¢ Disable Chrome updates during automation hours (optional)

   Advanced Settings:
   â€¢ Privacy and security > Site Settings > Additional permissions
   â€¢ Allow sites to access USB devices (for hardware interactions)
   â€¢ Clear browsing data regularly (cache, not passwords)

===============================================================================
ðŸ“ STEP 3: PROJECT FILES SETUP
===============================================================================

3.1 Copy Project Files:
   â€¢ Copy the entire MoonFlower Enhanced project folder to:
     C:\MoonFlower (recommended)
   â€¢ Or any location you prefer (system is portable)

3.2 Verify Enhanced File Structure:
   Your folder should contain:
   âœ… AutomationMaster_Enhanced.ps1 (main orchestrator)
   âœ… Install_Enhanced.ps1 (installation script)
   âœ… Configuration_Manager.ps1 (GUI config tool)
   âœ… Test_Enhanced_System.ps1 (comprehensive testing)
   âœ… daily_folder_creator.py
   âœ… email\ folder (outlook_automation.py, email_delivery.py)
   âœ… wifi\ folder (csv_downloader_resilient.py)
   âœ… excel\ folder (excel_generator.py)
   âœ… vbs\ folder (all phase files)
   âœ… utils\ folder (file_checker.py, close_vbs.py)
   âœ… Images\ folder (VBS automation images)

===============================================================================
ðŸ“¦ STEP 4: PYTHON PACKAGES INSTALLATION
===============================================================================

4.1 Open Command Prompt as Administrator:
   â€¢ Press Windows + X
   â€¢ Select "Command Prompt (Admin)" or "PowerShell (Admin)"

4.2 Navigate to Project Folder:
   â€¢ Type: cd C:\MoonFlower
   â€¢ Press Enter

4.3 Install Required Packages (Enhanced System):
   Copy and paste these commands one by one:

   pip install --upgrade pip
   pip install selenium
   pip install pyautogui
   pip install opencv-python
   pip install pandas
   pip install xlwt
   pip install openpyxl
   pip install pywin32
   pip install psutil
   pip install requests
   pip install chromedriver-autoinstaller
   pip install Pillow
   pip install numpy
   pip install webdriver-manager
   pip install pyinstaller

4.4 Verify Installation:
   â€¢ Type: python -c "import selenium, pyautogui, cv2, pandas, psutil; print('âœ… All packages installed successfully!')"
   â€¢ You should see: "âœ… All packages installed successfully!"

===============================================================================
ðŸ§ª STEP 5: SYSTEM VALIDATION
===============================================================================

5.1 Run Comprehensive Test:
   â€¢ Open PowerShell as Administrator
   â€¢ Navigate to: cd C:\MoonFlower
   â€¢ Run: powershell -ExecutionPolicy Bypass -File "Test_Enhanced_System.ps1"
   â€¢ Should show: "ðŸŽ‰ ALL TESTS PASSED! System is ready for production use."

5.2 Test Individual Components:
   â€¢ Python Environment: âœ… Should be detected
   â€¢ Python Scripts: âœ… All should be found
   â€¢ Network Connectivity: âœ… Should reach internet
   â€¢ File Permissions: âœ… Should have write access

===============================================================================
ðŸ¢ STEP 6: VBS SOFTWARE SETUP
===============================================================================

6.1 Install VBS Software:
   â€¢ Install your organization's VBS software
   â€¢ Make sure it opens and logs in correctly
   â€¢ Test all required navigation paths
   â€¢ Note any security prompts or login requirements

6.2 VBS Configuration:
   â€¢ Ensure VBS login credentials are saved
   â€¢ Test that VBS opens without security warnings
   â€¢ Verify file upload and report generation features
   â€¢ Close VBS after testing

===============================================================================
ðŸ“§ STEP 7: OUTLOOK CONFIGURATION
===============================================================================

7.1 Setup Organizational Outlook:
   â€¢ Install Microsoft Outlook (part of Office)
   â€¢ Configure with your organizational email account
   â€¢ Login and ensure it works normally
   â€¢ Test sending an email manually

7.2 Outlook Automation Setup:
   â€¢ Open Outlook at least once
   â€¢ Go to File > Options > Trust Center > Trust Center Settings
   â€¢ Select "Macro Settings"
   â€¢ Choose "Enable all macros" (for automation)
   â€¢ Click OK and restart Outlook

7.3 Configure Email Addresses:
   Edit these files to set your email addresses:
   â€¢ email\outlook_automation.py (for GM emails)
   â€¢ email\email_delivery.py (for error notifications)

===============================================================================
ðŸš€ STEP 8: INSTALL ENHANCED AUTOMATION SYSTEM
===============================================================================

8.1 Install as Windows Scheduled Task (RECOMMENDED):
   â€¢ Open PowerShell as Administrator
   â€¢ Navigate to: cd C:\MoonFlower
   â€¢ Run: powershell -ExecutionPolicy Bypass -File "Install_Enhanced.ps1"
   â€¢ Should show: "ðŸš€ MoonFlower AutomationMaster Enhanced is now installed!"

8.2 Verify Installation:
   â€¢ Check Task Scheduler (taskschd.msc)
   â€¢ Look for: "MoonFlower_AutomationMaster"
   â€¢ Task should be "Ready" state
   â€¢ Triggers: At startup, At logon, Daily at 00:01

8.3 Manual Configuration (Optional):
   â€¢ Run: powershell -ExecutionPolicy Bypass -File "Configuration_Manager.ps1"
   â€¢ Configure custom timings, CSV slots, email settings
   â€¢ Generate custom configuration if needed

===============================================================================
âš™ï¸ STEP 9: 365-DAY OPERATION FEATURES
===============================================================================

9.1 Automatic Operation Schedule:
   ðŸ“§ 08:30-09:30: GM Email (weekdays only, business day logic)
   ðŸ“„ 09:00-09:10: CSV Slot 1 (4 files minimum)
   ðŸ“„ 12:30-12:40: CSV Slot 2 (8 files total)
   ðŸ“Š 12:35-12:45: Excel merge (immediate after CSV)
   ðŸ”§ 12:40-16:00: VBS upload (3+ hour process)
   ðŸš« 16:00: VBS force closure (daily cleanup)
   ðŸ“‘ 17:01-18:00: VBS report generation (fresh session)
   ðŸ”„ All day: Catch-up monitoring

9.2 Error Recovery Features:
   â€¢ Network failures: Pre-operation connectivity checks
   â€¢ Missing files: File count validation with retries
   â€¢ Python errors: Timeout protection with process cleanup
   â€¢ VBS crashes: Force termination and fresh session restart
   â€¢ Email failures: Multiple notification attempts
   â€¢ State corruption: Automatic state file recovery

9.3 Advanced Monitoring:
   â€¢ Performance metrics: Task duration, memory usage, disk space
   â€¢ Alert thresholds: Configurable limits with email notifications
   â€¢ File reports: Daily integrity reports with JSON output
   â€¢ Status dashboard: Real-time system health display

===============================================================================
ðŸ§ª STEP 10: TESTING AND VERIFICATION
===============================================================================

10.1 View System Status:
   â€¢ Run: powershell -ExecutionPolicy Bypass -File "AutomationMaster_Enhanced.ps1" -Status
   â€¢ Should show current system health, daily progress, and file counts

10.2 Test Catch-up Logic:
   â€¢ Stop automation if running
   â€¢ Wait until after 10:00 AM
   â€¢ Start automation manually
   â€¢ Should detect missing files and download/process them

10.3 Monitor Log Files:
   â€¢ Location: EHC_Logs\automation_master_YYYYMMDD.log
   â€¢ Performance metrics: EHC_Logs\performance_metrics.json
   â€¢ File reports: EHC_Logs\file_report.json

===============================================================================
ðŸ”§ STEP 11: CHROME AUTOMATION SETTINGS (DETAILED)
===============================================================================

11.1 Chrome Flags for Automation (Optional):
   Create a desktop shortcut with these flags:
   Target: "C:\Program Files\Google\Chrome\Application\chrome.exe" --disable-web-security --disable-features=VizDisplayCompositor --user-data-dir="C:\ChromeAutomation"

11.2 Registry Settings (Advanced):
   If needed, disable Chrome security prompts:
   â€¢ Open Registry Editor (regedit)
   â€¢ Navigate to: HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Google\Chrome
   â€¢ Create DWORD: DefaultDownloadSecurityLevel = 0
   â€¢ Create DWORD: DownloadDirPolicy = 1

11.3 Group Policy (Enterprise):
   For enterprise environments:
   â€¢ Allow automation sites in managed bookmarks
   â€¢ Disable password manager prompts during automation
   â€¢ Set consistent download folder across all users

===============================================================================
ðŸ§° STEP 12: MAINTENANCE AND MONITORING
===============================================================================

12.1 Daily Monitoring:
   â€¢ Check EHC_Logs for any errors
   â€¢ Verify file counts in daily folders
   â€¢ Monitor system performance metrics
   â€¢ Review email delivery status

12.2 Weekly Maintenance:
   â€¢ Clean up old log files (>30 days)
   â€¢ Check disk space availability
   â€¢ Update Chrome browser if needed
   â€¢ Verify VBS software functionality

12.3 Configuration Changes:
   â€¢ Use Configuration_Manager.ps1 for GUI changes
   â€¢ Edit AutomationMaster_Enhanced.ps1 parameters directly
   â€¢ Reinstall scheduled task after major changes

===============================================================================
ðŸ†˜ STEP 13: TROUBLESHOOTING ENHANCED SYSTEM
===============================================================================

13.1 Installation Issues:
   â€¢ "Cannot be loaded because running scripts is disabled":
     Solution: powershell -ExecutionPolicy Bypass -File "script.ps1"
   
   â€¢ "Access denied" installing scheduled task:
     Solution: Run PowerShell as Administrator

13.2 Operation Issues:
   â€¢ Automation not starting after reboot:
     Check: Task Scheduler > MoonFlower_AutomationMaster > Properties > Conditions
   
   â€¢ Files not downloading:
     Check: Chrome settings, network connectivity, CSV downloader script

13.3 Performance Issues:
   â€¢ High memory usage:
     Check: Performance metrics file, consider restarting automation
   
   â€¢ Slow execution:
     Check: Network speed, disk space, background processes

===============================================================================
ðŸŽ¯ ENHANCED SYSTEM CHECKLIST
===============================================================================

Installation:
â–¡ Python installed with PATH
â–¡ Chrome configured for automation  
â–¡ Enhanced project files in place
â–¡ Python packages installed
â–¡ System validation tests passed
â–¡ VBS software installed and tested
â–¡ Outlook configured
â–¡ Scheduled task installed successfully

Operation:
â–¡ System status shows healthy
â–¡ Daily folders being created automatically
â–¡ CSV downloads working
â–¡ Excel merge functioning
â–¡ VBS phases executing properly
â–¡ PDF reports generating
â–¡ Email delivery working
â–¡ Performance metrics collecting
â–¡ Error notifications functioning

Monitoring:
â–¡ Log files being generated
â–¡ File integrity reports available
â–¡ Performance metrics tracking
â–¡ Alert thresholds configured
â–¡ Status monitoring setup

===============================================================================
ðŸ“ž SUPPORT COMMANDS
===============================================================================

Quick Commands:
â€¢ System Status: powershell -ExecutionPolicy Bypass -File "AutomationMaster_Enhanced.ps1" -Status
â€¢ Run Test: powershell -ExecutionPolicy Bypass -File "Test_Enhanced_System.ps1" -Quick
â€¢ Configure: powershell -ExecutionPolicy Bypass -File "Configuration_Manager.ps1"
â€¢ Install: powershell -ExecutionPolicy Bypass -File "Install_Enhanced.ps1"
â€¢ Uninstall: powershell -ExecutionPolicy Bypass -File "Install_Enhanced.ps1" -Uninstall

File Locations:
â€¢ System Scripts: C:\MoonFlower\*.ps1
â€¢ Python Scripts: C:\MoonFlower\[folders]\*.py
â€¢ Daily Data: C:\MoonFlower\EHC_Data\[date]\
â€¢ Excel Files: C:\MoonFlower\EHC_Data_Merge\[date]\
â€¢ PDF Reports: C:\MoonFlower\EHC_Data_Pdf\[date]\
â€¢ Logs: C:\MoonFlower\EHC_Logs\

===============================================================================
ðŸŽ‰ INSTALLATION COMPLETE!
===============================================================================

Your MoonFlower AutomationMaster Enhanced system is now ready for 365-day
continuous operation with:

âœ… Automatic restart after PC reboot
âœ… Self-healing error recovery
âœ… Performance monitoring and alerting
âœ… File integrity validation
âœ… Catch-up logic for missed tasks
âœ… Network connectivity validation
âœ… Advanced configuration management

The system will now run automatically and handle all daily tasks with
minimal intervention required!

===============================================================================