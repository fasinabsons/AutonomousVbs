MOONFLOWER HOTEL WIFI AUTOMATION SYSTEM - COMPLETE FLOW
================================================================
AUTOMATA: CSV ‚Üí EXCEL ‚Üí VBS ‚Üí PDF ‚Üí EMAIL
================================================================

üéØ SYSTEM OVERVIEW:
Complete automated WiFi data collection, processing, and reporting system
for MoonFlower Hotel. Operates 365 days/year with scheduled data collection,
processing, and management reporting.

üìã COMPLETE AUTOMATION FLOW:
================================================================

üïò PHASE 1: CSV DATA COLLECTION
--------------------------------
SCHEDULE:
‚Ä¢ Morning Slot: 09:30 AM (collect 4 network files)
‚Ä¢ Afternoon Slot: 12:30 PM (collect 4 network files)
‚Ä¢ Maximum deadline: 01:30 PM

NETWORKS MONITORED:
1. EHC TV Network
2. EHC-15 Network  
3. Reception Hall-Mobile Network
4. Reception Hall-TV Network

AUTOMATED ACTIONS:
‚úÖ Download CSV files from WiFi controller
‚úÖ Save to EHC_Data/{date} folder (e.g., EHC_Data/25jul)
‚úÖ Validate file integrity and content
‚úÖ Email notification after complete slots only

OUTPUT: 8 CSV files total (4 morning + 4 afternoon)

üïê PHASE 2: EXCEL GENERATION & MERGE
------------------------------------
SCHEDULE:
‚Ä¢ Execute at: 01:35 PM (after CSV collection complete)
‚Ä¢ Completion by: 01:36 PM

AUTOMATED ACTIONS:
‚úÖ Merge all 8 CSV files into single Excel file
‚úÖ Map CSV columns to VBS-compatible format:
   - Hostname ‚Üí Hostname
   - IP Address ‚Üí IP_Address
   - MAC Address ‚Üí MAC_Address
   - WLAN (SSID) ‚Üí Package
   - AP MAC ‚Üí AP_MAC
   - Data Rate (up) ‚Üí Upload
   - Data Rate (down) ‚Üí Download
‚úÖ Save as EHC_Upload_Mac_{DDMMYYYY}.xls in EHC_Data_Merge/{date}
‚úÖ Email notification with file attachment
‚úÖ Validate Excel file is not empty and has correct structure

OUTPUT: Single Excel file ready for VBS processing

üïë PHASE 3: VBS DATA UPLOAD (CRITICAL PHASE)
--------------------------------------------
SCHEDULE:
‚Ä¢ Start at: 02:00 PM (configurable via frontend)
‚Ä¢ Upload duration: 2-5 hours (VBS processing time)
‚Ä¢ "Not Responding" state: NORMAL during upload

CRITICAL SEQUENCE:
1. ‚úÖ Click Import EHC checkbox (01_import_ehc_checkbox.png)
2. ‚úÖ Click 3 dots button + INSTANT ENTER (popup sound detection)
3. ‚úÖ Address bar navigation (optimization - skip 6 manual steps)
4. ‚úÖ Select Excel file and click Open
5. ‚úÖ **CRITICAL**: Re-click 3 dots ‚Üí RIGHT ‚Üí ENTER ‚Üí TAB ‚Üí type "EHC_Data"
6. ‚úÖ **CRITICAL**: Click Import button (13_import_button.png) - NEVER MISS
7. ‚úÖ Audio detection: Listen for import success popup sound
8. ‚úÖ Press ENTER when 14_import_ok_button appears with sound
9. ‚úÖ Click EHC User Detail header (15_ehc_user_detail_header.png)
10. ‚úÖ Double-click Update button (16_update_button.png)
11. ‚úÖ **CRITICAL**: Upload monitoring (up to 5 hours with audio detection)
12. ‚úÖ Close VBS application after upload success (wait 30 seconds)

AUDIO DETECTION POINTS:
üîä 3 dots click sound (verification audio system works)
üîä Import success popup sound (import completion)
üîä Update completion sound (upload finished)

OUTPUT: Data uploaded to VBS system, ready for report generation

üïï PHASE 4: PDF REPORT GENERATION
---------------------------------
SCHEDULE:
‚Ä¢ Execute after: Phase 3 upload completion
‚Ä¢ VBS restart: Automatic via Phase 1

AUTOMATED ACTIONS:
‚úÖ Navigate VBS Reports menu
‚úÖ Select "WiFi Active Users Count" (54 DOWN arrows + ENTER)
‚úÖ Set date range (From/To current date)
‚úÖ Generate and print report (1 minute wait)
‚úÖ Export to PDF with date-based filename
‚úÖ Save to EHC_Data_Pdf/{date} folder

OUTPUT: Daily WiFi usage PDF report

üïò PHASE 5: EMAIL DELIVERY TO GENERAL MANAGER
---------------------------------------------
SCHEDULE:
‚Ä¢ Send time: 09:00 AM - 09:45 AM (next morning)
‚Ä¢ Random timing: 09:07 AM, 09:03 AM, 09:33 AM etc. (configurable)
‚Ä¢ Natural schedule variation to avoid automation detection

EMAIL CONFIGURATION:
‚Ä¢ SMTP: Outlook (smtp-mail.outlook.com:587)
‚Ä¢ Recipient: General Manager email
‚Ä¢ Subject: "üìÑ Daily WiFi Report - {date} - MoonFlower Hotel"
‚Ä¢ Attachment: PDF report from Phase 4

AUTOMATED ACTIONS:
‚úÖ Professional email body with report details
‚úÖ PDF attachment (validate file exists and size)
‚úÖ Delivery confirmation logging
‚úÖ Fallback to testing email if GM delivery fails

OUTPUT: GM receives daily WiFi report

üìä PHASE 6: VALIDATION & MONITORING
-----------------------------------
AUTOMATED CHECKS:
‚úÖ check.py: PDF content validation
‚úÖ Compare today's vs yesterday's "Total Active User Count"
‚úÖ Validate Excel file has correct row count and structure
‚úÖ Email delivery confirmation
‚úÖ System health monitoring

VALIDATION CRITERIA:
‚Ä¢ Today's active users > Yesterday's active users (growth validation)
‚Ä¢ Excel file not empty (minimum 100 rows expected)
‚Ä¢ PDF contains expected report sections
‚Ä¢ All network data properly merged

ERROR HANDLING:
üö® Email alerts for critical failures
üìß Development notifications for issues
üîÑ Automatic retry mechanisms
üìù Comprehensive logging for troubleshooting

================================================================
‚öôÔ∏è SYSTEM CONFIGURATION
================================================================

üïí TIME SCHEDULE (CONFIGURABLE):
Morning CSV: 09:30 AM
Afternoon CSV: 12:30 PM
Excel Merge: 01:35 PM
VBS Upload: 02:00 PM (configurable)
PDF Generation: After upload completion
Email Delivery: 09:00-09:45 AM next day (random, configurable)

üìÅ DIRECTORY STRUCTURE:
EHC_Data/{date}/          - CSV files storage
EHC_Data_Merge/{date}/    - Excel files storage  
EHC_Data_Pdf/{date}/      - PDF reports storage
EHC_Logs/{date}/          - System logs

üéõÔ∏è FRONTEND CONFIGURATION:
‚Ä¢ Upload time adjustment (default 02:00 PM)
‚Ä¢ Email delivery time range (default 09:00-09:45 AM)
‚Ä¢ Random timing patterns
‚Ä¢ System monitoring dashboard
‚Ä¢ Manual triggers for each phase
‚Ä¢ Log file viewer
‚Ä¢ Progress tracking

================================================================
üîß TECHNICAL IMPLEMENTATION
================================================================

CORE COMPONENTS:
1. csv_downloader_resilient.py - WiFi data collection
2. excel_generator.py - CSV to Excel conversion
3. vbs_phase3_upload_complete.py - VBS data upload (CRITICAL)
4. vbs_phase4_report_fixed.py - PDF report generation
5. email_delivery.py - Professional email system
6. check.py - PDF and Excel validation
7. master_automation_orchestrator.py - Complete flow coordination

AUDIO DETECTION:
‚Ä¢ vbs_audio_detector.py - Popup sound detection
‚Ä¢ Three critical detection points in Phase 3
‚Ä¢ Fallback visual confirmation methods
‚Ä¢ Timeout handling for long operations

PATH MANAGEMENT:
‚Ä¢ utils/path_manager.py - Centralized path configuration
‚Ä¢ config/paths_config.json - Absolute path definitions
‚Ä¢ Cross-component consistency

ERROR HANDLING:
‚Ä¢ Comprehensive logging at each phase
‚Ä¢ Email notifications for failures
‚Ä¢ Automatic retry mechanisms  
‚Ä¢ Manual intervention alerts

SCHEDULING:
‚Ä¢ Windows Task Scheduler integration
‚Ä¢ Service-based operation (365-day uptime)
‚Ä¢ Configurable timing via frontend
‚Ä¢ Random delivery patterns

================================================================
üéØ SUCCESS CRITERIA
================================================================

DAILY OPERATION:
‚úÖ 8 CSV files collected (4 morning + 4 afternoon)
‚úÖ 1 Excel file generated with all network data
‚úÖ VBS upload completed successfully (audio confirmation)
‚úÖ 1 PDF report generated with current date
‚úÖ Email delivered to GM between 09:00-09:45 AM
‚úÖ Validation confirms data growth and integrity

MONITORING METRICS:
‚Ä¢ CSV collection success rate: 100%
‚Ä¢ Excel generation success rate: 100%
‚Ä¢ VBS upload success rate: 100% (CRITICAL)
‚Ä¢ PDF generation success rate: 100%
‚Ä¢ Email delivery success rate: 100%
‚Ä¢ Data validation pass rate: 100%

PERFORMANCE TARGETS:
‚Ä¢ CSV collection: < 5 minutes per slot
‚Ä¢ Excel generation: < 2 minutes
‚Ä¢ VBS upload: 2-5 hours (normal processing time)
‚Ä¢ PDF generation: < 10 minutes
‚Ä¢ Email delivery: < 1 minute
‚Ä¢ Total automation cycle: < 6 hours (CSV to PDF ready)

================================================================
üöÄ DEPLOYMENT & OPERATION
================================================================

INSTALLATION:
1. Run universal_installer.py
2. Configure email credentials
3. Set up Windows service
4. Configure frontend access
5. Test complete flow

DAILY MONITORING:
‚Ä¢ Check email notifications
‚Ä¢ Review system logs
‚Ä¢ Validate PDF reports
‚Ä¢ Monitor VBS upload completion
‚Ä¢ Verify data growth trends

MAINTENANCE:
‚Ä¢ Weekly log cleanup
‚Ä¢ Monthly performance review
‚Ä¢ Quarterly system updates
‚Ä¢ Annual configuration review

================================================================
üìû SUPPORT & CONTACT
================================================================

AUTOMATED NOTIFICATIONS:
‚Ä¢ Development: faseenm@gmail.com
‚Ä¢ Testing: faseen1532@gmail.com  
‚Ä¢ General Manager: {configured_gm_email}

MANUAL INTERVENTION:
‚Ä¢ If Phase 3 upload fails: Check VBS application state
‚Ä¢ If email delivery fails: Verify SMTP configuration
‚Ä¢ If PDF validation fails: Review data collection integrity
‚Ä¢ If system stops: Restart Windows service

================================================================
END OF AUTOMATA SPECIFICATION
================================================================

This document defines the complete automation flow for MoonFlower Hotel
WiFi management system. The system operates continuously, providing daily
WiFi usage reports to management while maintaining full automation and
minimal manual intervention requirements.

CRITICAL SUCCESS FACTOR: Phase 3 VBS upload must complete successfully
as it is the core of the entire automation system. All other phases
depend on this critical data upload operation.

Version: 1.0
Last Updated: {datetime.now().strftime('%d %B %Y')}
System Status: OPERATIONAL ‚úÖ 